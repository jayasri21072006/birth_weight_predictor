from flask import Flask, render_template, request
import numpy as np
import joblib

app = Flask(__name__)

model = joblib.load("model.pkl")

@app.route("/")
def home():
    return render_template("index.html")

@app.route("/predict", methods=["POST"])
def predict():

    # Get form values
    gestation = float(request.form["gestation"])
    parity = float(request.form["parity"])
    age = float(request.form["age"])
    height_cm = float(request.form["height"])
    weight_kg = float(request.form["weight"])
    smoke = float(request.form["smoke"])

    # ðŸ”¥ Convert input to training units
    height_inches = height_cm / 2.54
    weight_pounds = weight_kg * 2.20462

    # Model input
    input_data = np.array([[gestation, parity, age, height_inches, weight_pounds, smoke]])

    prediction_ounces = model.predict(input_data)[0]

    # ðŸ”¥ Convert output
    prediction_grams = prediction_ounces * 28.3495
    prediction_kg = prediction_grams / 1000

    return render_template(
        "index.html",
        prediction_grams=round(prediction_grams, 2),
        prediction_kg=round(prediction_kg, 2),
        gestation=gestation,
        parity=parity,
        age=age,
        height=height_cm,
        weight=weight_kg,
        smoke=smoke
    )

if __name__ == "__main__":
    app.run(debug=True)
